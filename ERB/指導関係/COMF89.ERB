;-------------------------------------------------
;獣姦プレイ
;-------------------------------------------------
@COM89
PRINTL 獣姦プレイ
SAVESTR:0 = 獣姦プレイ
CALL TRAIN_MESSAGE_B

IF TEQUIP:獣姦プレイ
	TEQUIP:獣姦プレイ = 0
ELSE
	TEQUIP:獣姦プレイ = 1
ENDIF
T = 0
RETURN 1

;-------------------------------------------------
;-------------------------------------------------
;獣姦プレイ中
;-------------------------------------------------
@EQUIP_COM89
PRINTL ＜獣姦プレイ中＞

T = 1

;EXP:獣姦経験をみる
IF EXP:獣姦経験 < EXPLV:1
	A = 400
	B = 2000
ELSEIF EXP:獣姦経験 < EXPLV:2
	A = 200
	B = 1000
ELSEIF EXP:獣姦経験 < EXPLV:3
	A = 100
	B = 500
ELSEIF EXP:獣姦経験 < EXPLV:4
	A = 50
	B = 200
ELSEIF EXP:獣姦経験 < EXPLV:5
	A = 20
	B = 100
ELSE
	A = 10
	B = 50
ENDIF

;ABL:獣姦中毒をみる
IF ABL:獣姦中毒 == 0
	TIMES A , 1.50
	TIMES B , 1.50
ELSEIF ABL:獣姦中毒 == 1
	TIMES A , 1.00
	TIMES B , 1.00
	SOURCE:7 += 100
ELSEIF ABL:獣姦中毒 == 2
	TIMES A , 0.80
	TIMES B , 0.80
	SOURCE:7 += 400
ELSEIF ABL:獣姦中毒 == 3
	TIMES A , 0.60
	TIMES B , 0.60
	SOURCE:7 += 1200
ELSEIF ABL:獣姦中毒 == 4
	TIMES A , 0.40
	TIMES B , 0.40
	SOURCE:7 += 3000
ELSE
	TIMES A , 0.20
	TIMES B , 0.20
	SOURCE:7 += 5000
ENDIF

;感情乏しい
SIF TALENT:感情乏しい
	TIMES B , 0.60
;動物耳
SIF TALENT:動物耳
	TIMES B , 0.50
;牝犬
IF TALENT:牝犬
	TIMES A , 0.20
	TIMES B , 0.20
ENDIF

LOSEBASE:気力 += A

SOURCE:8 += B
SOURCE:14 += B

SOURCE:10 += 200

TIMES SOURCE:0 , 1.50
TIMES SOURCE:2 , 1.50
TIMES SOURCE:17 , 1.50
TIMES SOURCE:6 , 1.50
TIMES SOURCE:13 , 3.00

;動物耳なら屈従半減
SIF TALENT:動物耳
	SOURCE:13 /= 2

;牝犬なら効果増大
IF TALENT:牝犬
	TIMES SOURCE:3 , 1.20
	TIMES SOURCE:4 , 1.20
	TIMES SOURCE:5 , 1.20
	TIMES SOURCE:7 , 2.00
	TIMES SOURCE:10 , 3.00
ENDIF

IF SELECTCOM == 21 || SELECTCOM == 27 || SELECTCOM == 37
	TIMES SOURCE:14 , 2.00
ENDIF

IF EXP:獣姦経験 == 0
	EXP:異常経験 += 1
	PRINTL 異常経験＋1
ENDIF

;-------------------------------------------------
;射精チェック
;-------------------------------------------------
SIF MAXBASE:MASTER:異種射精ゲージ == 0
	GOTO END_EJAC

B = 0

;ABL:技巧をみる
IF ABL:技巧 == 0
	B = 450
ELSEIF ABL:技巧 == 1
	B = 1000
ELSEIF ABL:技巧 == 2
	B = 1600
ELSEIF ABL:技巧 == 3
	B = 2200
ELSEIF ABL:技巧 == 4
	B = 2700
ELSE
	B = 3200
ENDIF

;ABL:従順をみる
IF ABL:信頼 == 0
	TIMES B , 0.30
ELSEIF ABL:信頼 == 1
	TIMES B , 0.50
ELSEIF ABL:信頼 == 2
	TIMES B , 0.70
ELSEIF ABL:信頼 == 3
	TIMES B , 1.00
ELSEIF ABL:信頼 == 4
	TIMES B , 1.20
ELSE
	TIMES B , 1.30
ENDIF

;ABL:獣姦中毒をみる
IF ABL:噴乳中毒 == 0
	TIMES B , 1.00
ELSEIF ABL:噴乳中毒 == 1
	TIMES B , 1.20
ELSEIF ABL:噴乳中毒 == 2
	TIMES B , 1.80
ELSEIF ABL:噴乳中毒 == 3
	TIMES B , 2.60
ELSEIF ABL:噴乳中毒 == 4
	TIMES B , 4.00
ELSE
	TIMES B , 5.00
ENDIF

;PALAM:欲情をみる
IF PALAM:欲情 < PALAMLV:1
	TIMES B , 1.00
ELSEIF PALAM:欲情 < PALAMLV:2
	TIMES B , 1.10
ELSEIF PALAM:欲情 < PALAMLV:3
	TIMES B , 1.20
ELSEIF PALAM:欲情 < PALAMLV:4
	TIMES B , 1.30
ELSEIF PALAM:欲情 < PALAMLV:5
	TIMES B , 1.40
ELSE
	TIMES B , 1.50
ENDIF

;動物耳
SIF TALENT:動物耳
	TIMES B , 1.20
;牝犬
SIF TALENT:牝犬
	TIMES B , 2.00

;キス
IF SELECTCOM == 6
	B = 0
	T += 2
;後背位
ELSEIF SELECTCOM == 21
	TIMES B , 1.00
	T += 2
;後背位アナル
ELSEIF SELECTCOM == 27
	TIMES B , 1.50
	T += 2
;手淫
ELSEIF SELECTCOM == 30
	TIMES B , 0.80
	T += 1
;フェラチオ
ELSEIF SELECTCOM == 31
	TIMES B , 1.20
	T += 2
;騎乗位
ELSEIF SELECTCOM == 34
	TIMES B , 1.50
	T += 3
ELSE
	B = 0
ENDIF

BASE:MASTER:異種射精ゲージ += B

S = BASE:MASTER:異種射精ゲージ
EJAC = MAXBASE:MASTER:異種射精ゲージ

IF  S > EJAC * 2
	E = 2
ELSEIF S > EJAC
	E = 1
ELSE
	E = 0
ENDIF

IF E
;射精している
	TIMES SOURCE:4 , 3.00

	;ABL:精液中毒をみる
	IF ABL:精液中毒 == 0
		SOURCE:7 = 0
		TIMES SOURCE:5 , 2.00
		TIMES SOURCE:13, 2.00
	ELSEIF ABL:精液中毒 == 1
		SOURCE:7 = 200
		TIMES SOURCE:5 , 2.50
		TIMES SOURCE:13, 1.60
	ELSEIF ABL:精液中毒 == 2
		SOURCE:7 = 500
		TIMES SOURCE:5 , 3.00
		TIMES SOURCE:13, 1.00
	ELSEIF ABL:精液中毒 == 3
		SOURCE:7 = 1200
		TIMES SOURCE:5 , 4.50
		TIMES SOURCE:13, 0.70
	ELSEIF ABL:精液中毒 == 4
		SOURCE:7 = 2500
		TIMES SOURCE:5 , 6.00
		TIMES SOURCE:13, 0.40
	ELSE
		SOURCE:7 = 5000
		TIMES SOURCE:5 , 8.00
		TIMES SOURCE:13, 0.10
	ENDIF
ENDIF

;大量射精
IF E == 2
	EXP:精液経験 += 3
	PRINTL 獣姦大量射精
	PRINTL 精液経験＋３
	T += 5

	BASE:MASTER:異種射精ゲージ -= EJAC*2
	SIF BASE:MASTER:異種射精ゲージ >= EJAC
		BASE:MASTER:異種射精ゲージ = EJAC-1
	;膣内射精フラグ（犬）
	SIF SELECTCOM == 21 || SELECTCOM == 34
		TFLAG:調教対象の膣内に射精 = 2
	
;通常の射精
ELSEIF E == 1
	EXP:精液経験 += 1
	PRINTL 獣姦射精
	PRINTL 精液経験＋１
	T += 2

	BASE:MASTER:異種射精ゲージ -= EJAC
	SIF BASE:MASTER:異種射精ゲージ >= EJAC
		BASE:MASTER:異種射精ゲージ = EJAC-1
	;膣内射精フラグ（犬）
	SIF SELECTCOM == 21 || SELECTCOM == 34
		TFLAG:調教対象の膣内に射精 = 1
ENDIF

$END_EJAC

;-------------------------------------------------
;汚れ
;-------------------------------------------------
SIF SELECTCOM == 21
	STAIN:3 |= 2
SIF SELECTCOM == 27
	STAIN:4 |= 2
SIF SELECTCOM == 30
	STAIN:1 |= 2
SIF SELECTCOM == 31
	STAIN:0 |= 2
SIF SELECTCOM == 37
	STAIN:0 |= 8
SIF SELECTCOM == 21 && E > 0
	STAIN:3 |= 4
SIF SELECTCOM == 27 && E > 0
	STAIN:4 |= 4
SIF SELECTCOM == 30 && E > 0
	STAIN:1 |= 4
SIF SELECTCOM == 31 && E > 0
	STAIN:0 |= 4

;犬が射精フラグ
TFLAG:犬が射精 = E

PRINTFORML 獣姦経験＋{T}
EXP:獣姦経験 += T

T = 0

;獣姦で処女喪失だと異常経験が２付く（【動物耳】除く）
IF TALENT:処女 && TFLAG:V経験を伴うコマンド && TALENT:動物耳 == 0
	EXP:異常経験 += 2
	PRINTL 異常経験＋２
ENDIF

;獣姦で手淫なら屈服刻印２
IF SELECTCOM == 30
	;屈服刻印２に相当
	TFLAG:屈服刻印2 = 2
;獣姦でフェラチオ・後背位・後背位アナル・アナル奉仕・騎乗位だと屈服刻印３
ELSEIF SELECTCOM == 31 || SELECTCOM == 21 || SELECTCOM == 27 || SELECTCOM == 34 || SELECTCOM == 37
	;屈服刻印３に相当
	TFLAG:屈服刻印2 = 3
ENDIF

RETURN 1
;
