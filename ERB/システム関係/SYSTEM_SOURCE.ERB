;｢CALL MASTER_SKILL_CHECK｣｢CALL MASTER_FLAG_CHECK｣｢CALL TRAIN_MESSAGE_A｣を追加
;｢CALL ECST_CHECK｣を追加
;口上用の処理を追加。FLAG:7で管理

@SOURCE_CHECK
;-------------------------------------------------
;コマンド実行時の口上
;-------------------------------------------------
SIF FLAG:口上使用 > 0
	CALL KOJO_MESSAGE_COM

;-------------------------------------------------
;コンドームの使用チェック（調教者）
;-------------------------------------------------
;コンドームを付けた調教者が射精
;調教者が主人
IF ASSIPLAY == 0 && TEQUIP:主人コンドーム && (TFLAG:口で射精 || TFLAG:手で射精 || TFLAG:セックスで射精 || TFLAG:キスで射精 || TFLAG:クンニで射精 || TFLAG:主人が助手を犯すで射精 || TFLAG:フェラで射精後 || TFLAG:素股で射精 || TFLAG:足で射精)
	PRINTL コンドームの中に射精
	TEQUIP:主人コンドーム = 0
	TFLAG:口で射精 = 0
	TFLAG:手で射精 = 0
	TFLAG:セックスで射精 = 0
	TFLAG:キスで射精 = 0
	TFLAG:クンニで射精 = 0
	TFLAG:主人が助手を犯すで射精 = 0
	TFLAG:フェラで射精後 = 0
	TFLAG:素股で射精 = 0
	TFLAG:足で射精 = 0
	TFLAG:900 = 1
;調教者が助手
ELSEIF ASSIPLAY && TEQUIP:助手コンドーム && (TFLAG:口で射精 || TFLAG:手で射精 || TFLAG:セックスで射精 || TFLAG:キスで射精 || TFLAG:クンニで射精 || TFLAG:主人が助手を犯すで射精 || TFLAG:フェラで射精後 || TFLAG:素股で射精 || TFLAG:足で射精)
	PRINTL コンドームの中に射精
	TEQUIP:助手コンドーム = 0
	TFLAG:口で射精 = 0
	TFLAG:手で射精 = 0
	TFLAG:セックスで射精 = 0
	TFLAG:キスで射精 = 0
	TFLAG:クンニで射精 = 0
	TFLAG:主人が助手を犯すで射精 = 0
	TFLAG:フェラで射精後 = 0
	TFLAG:素股で射精 = 0
	TFLAG:足で射精 = 0
	TFLAG:900 = 1
ENDIF

;コンドームを付けた助手が射精
IF TEQUIP:助手コンドーム && TFLAG:助手が射精 && ASSI > 0
	PRINTFORML コンドームの中に射精（%CALLNAME:ASSI%）
	TEQUIP:助手コンドーム = 0
	TFLAG:助手が射精 = 0
	TFLAG:900 = 1
ENDIF

DRAWLINE
;-------------------------------------------------
;バイブなど付けっぱなしアイテムのチェック
;-------------------------------------------------

;バイブ装着中
SIF TEQUIP:バイブ
	CALL EQUIP_COM11
;アナルバイブ装着中
SIF TEQUIP:アナルバイブ
	CALL EQUIP_COM13
;クリキャップ装着中
SIF TEQUIP:クリキャップ
	CALL EQUIP_COM14
;ニプルキャップ装着中
SIF TEQUIP:ニプルキャップ
	CALL EQUIP_COM15
;搾乳器装着中
SIF TEQUIP:搾乳機
	CALL EQUIP_COM16
;オナホール装着中
SIF TEQUIP:オナホール
	CALL EQUIP_COM17
;シャワー使用中
SIF TEQUIP:シャワー
	CALL EQUIP_COM18
;アナルビーズ使用中
SIF TEQUIP:アナルビーズ
	CALL EQUIP_COM19
;アイマスク装着中
SIF TEQUIP:アイマスク
	CALL EQUIP_COM43
;縄で緊縛中
SIF TEQUIP:縄
	CALL EQUIP_COM44
;ボールギャグ装着中
SIF TEQUIP:ボールギャグ
	CALL EQUIP_COM45
;浣腸＋アナルプラグ装着中
SIF TEQUIP:浣腸セット
	CALL EQUIP_COM46
;助手がボンデージ装着中
SIF TEQUIP:助手ボンデージ
	CALL EQUIP_COM47
;アナル電極装着中
SIF TEQUIP:アナル電極
	CALL EQUIP_COM49
;ビデオ撮影中
SIF TEQUIP:撮影中
	CALL EQUIP_COM53
;野外プレイ中
SIF TEQUIP:野外プレイ
	CALL EQUIP_COM54
;羞恥プレイ中
SIF TEQUIP:羞恥大鏡プレイ
	CALL EQUIP_COM57
;お風呂場プレイ中
SIF TEQUIP:お風呂場プレイ
	CALL EQUIP_COM58
;新妻プレイ中
SIF TEQUIP:コスプレ
	CALL EQUIP_COM59
;獣姦プレイ中
SIF TEQUIP:獣姦プレイ
	CALL EQUIP_COM89
;触手調教中
SIF TEQUIP:触手召喚
	CALL EQUIP_COM100
;触手口辱中
SIF TEQUIP:触手口辱
	CALL EQUIP_COM108
SIF TEQUIP:顔面騎乗
	CALL EQUIP_COM135
						;****追加ここから****
;三角木馬騎乗中
SIF TEQUIP:三角木馬騎乗
		CALL EQUIP_COM137
PRINTL  
						;****追加ここまで****
;****スライムパッチ追加ここから****
;スライム膣内進入中
SIF TEQUIP:スライム膣内進入
	CALL EQUIP_COM151
;スライム肛門進入中
SIF TEQUIP:スライム肛門進入
	CALL EQUIP_COM152
;スライム口辱中
SIF TEQUIP:スライム口辱
	CALL EQUIP_COM154
;スライム調教中
SIF TEQUIP:スライム生成
	CALL EQUIP_COM150
						;****スライムパッチ追加ここまで****


;-------------------------------------------------
;同性のチェック、調教者の能力のチェック
;-------------------------------------------------
CALL SOURCE_SEX_CHECK
CALL PLAYER_SKILL_CHECK
CALL MASTER_SKILL_CHECK
;-------------------------------------------------
;コスチュームによる効果
;-------------------------------------------------
;ズーコの着ぐるみを着ている
IF CFLAG:特別コスタイプ == 11 && (CFLAG:着衣状態 & 64)
	TIMES SOURCE:痛覚 , 0.10
	IF TEQUIP:触手召喚 == 0
		TIMES SOURCE:快Ｃ , 0.10
		TIMES SOURCE:快Ｖ , 0.10
		TIMES SOURCE:快Ａ , 0.10
		TIMES SOURCE:快Ｂ , 0.10
	ENDIF
ENDIF

;-------------------------------------------------
;近親相姦
;-------------------------------------------------
CALL INCEST_SEX_CHECK
;-------------------------------------------------
;処女喪失のチェック
;-------------------------------------------------
CALL FIRSTKISS_PLAYER_CHECK
;-------------------------------------------------
;処女喪失のチェック
;-------------------------------------------------
CALL FIRSTKISS_TARGET_CHECK
;-------------------------------------------------
;処女喪失のチェック
;-------------------------------------------------
CALL FIRSTKISS_ASSI_CHECK
;-------------------------------------------------
;処女喪失のチェック
;-------------------------------------------------
CALL LOST_VIRGIN_CHECK
;-------------------------------------------------
;処女喪失のチェック
;-------------------------------------------------
CALL LOST_ANALVIRGIN_CHECK

;-------------------------------------------------
;快Ｃのソース
;-------------------------------------------------
;Ｃ敏感とＣ鈍感はここで処理
SIF TALENT:Ｃ鈍感
	TIMES SOURCE:快Ｃ , 0.50
SIF TALENT:Ｃ敏感
	TIMES SOURCE:快Ｃ , 2.00

A = SOURCE:快Ｃ

;PALAM:欲情をみる
IF TFLAG:201 == 1
	TIMES A , 1.00
ELSEIF PALAM:欲情 < PALAMLV:1
	TIMES A , 0.50
ELSEIF PALAM:欲情 < PALAMLV:2
	TIMES A , 0.70
ELSEIF PALAM:欲情 < PALAMLV:3
	TIMES A , 1.00
ELSEIF PALAM:欲情 < PALAMLV:4
	TIMES A , 1.30
ELSEIF PALAM:欲情 >= PALAMLV:4
	TIMES A , 1.80
ENDIF

B = SOURCE:快Ｃ

;ABL:欲望をみる
IF ABL:欲望 == 0
	TIMES B , 0.10
ELSEIF ABL:欲望 == 1
	TIMES B , 0.15
ELSEIF ABL:欲望 == 2
	TIMES B , 0.20
ELSEIF ABL:欲望 == 3
	TIMES B , 0.25
ELSEIF ABL:欲望 == 4
	TIMES B , 0.30
ELSEIF ABL:欲望 == 5
	TIMES B , 0.40
ELSE
	TIMES B , 0.50
ENDIF

;快感の否定、抑圧、抵抗
IF TALENT:抑圧 || TALENT:抵抗 || TALENT:快感の否定
	C = SOURCE:快Ｃ / 3
	;ABL:欲望をみる
	IF ABL:欲望 == 0
		TIMES C , 1.00
	ELSEIF ABL:欲望 == 1
		TIMES C , 0.85
	ELSEIF ABL:欲望 == 2
		TIMES C , 0.70
	ELSEIF ABL:欲望 == 3
		TIMES C , 0.40
	ELSEIF ABL:欲望 == 4
		TIMES C , 0.30
	ELSEIF ABL:欲望 == 5
		TIMES C , 0.10
	ELSE
		C = 0
	ENDIF
ELSE
	C = 0
ENDIF

;自慰狂い
IF TALENT:自慰狂い
	TIMES A , 1.50
	TIMES B , 1.20
	TIMES C , 0.50
ENDIF

;淫核
IF TALENT:淫核
	TIMES A , 2.00
ENDIF

;PALAM:快Ｃの上昇
UP:[[UP:快Ｃ]] += A
;PALAM:欲情の上昇
UP:[[UP:欲情]] += B
;PALAM:抑鬱の上昇
UP:[[UP:抑鬱]] += C

;-------------------------------------------------
;快Ｖのソース
;-------------------------------------------------
;Ｖ敏感とＶ鈍感はここで処理
SIF TALENT:Ｖ鈍感
	TIMES SOURCE:快Ｖ , 0.50
SIF TALENT:Ｖ敏感
	TIMES SOURCE:快Ｖ , 2.00

A = SOURCE:快Ｖ

;PALAM:欲情をみる
IF TFLAG:201 == 1
	TIMES A , 1.00
ELSEIF PALAM:欲情 < PALAMLV:1
	TIMES A , 0.30
ELSEIF PALAM:欲情 < PALAMLV:2
	TIMES A , 0.50
ELSEIF PALAM:欲情 < PALAMLV:3
	TIMES A , 1.00
ELSEIF PALAM:欲情 < PALAMLV:4
	TIMES A , 1.50
ELSEIF PALAM:欲情 >= PALAMLV:4
	TIMES A , 2.00
ENDIF

B = SOURCE:快Ｖ

;ABL:欲望をみる
IF ABL:欲望 == 0
	TIMES B , 0.10
ELSEIF ABL:欲望 == 1
	TIMES B , 0.15
ELSEIF ABL:欲望 == 2
	TIMES B , 0.20
ELSEIF ABL:欲望 == 3
	TIMES B , 0.25
ELSEIF ABL:欲望 == 4
	TIMES B , 0.30
ELSEIF ABL:欲望 == 5
	TIMES B , 0.40
ELSE
	TIMES B , 0.50
ENDIF

;快感の否定、抑圧、抵抗
IF TALENT:抑圧 || TALENT:抵抗 || TALENT:快感の否定
	C = SOURCE:快Ｖ / 3
	;ABL:欲望をみる
	IF ABL:欲望 == 0
		TIMES C , 1.00
	ELSEIF ABL:欲望 == 1
		TIMES C , 0.85
	ELSEIF ABL:欲望 == 2
		TIMES C , 0.70
	ELSEIF ABL:欲望 == 3
		TIMES C , 0.40
	ELSEIF ABL:欲望 == 4
		TIMES C , 0.30
	ELSEIF ABL:欲望 == 5
		TIMES C , 0.10
	ELSE
		C = 0
	ENDIF
ELSE
	C = 0
ENDIF

;セックス狂
IF TALENT:セックス狂
	TIMES A , 1.50
	TIMES B , 1.20
	TIMES C , 0.50
ENDIF

;淫壷
IF TALENT:淫壺
	TIMES A , 1.50
ENDIF

;PALAM:快Ｖの上昇
UP:[[UP:快Ｖ]] += A
;PALAM:恭順の上昇
UP:[[UP:恭順]] += B
;PALAM:欲情の上昇
UP:[[UP:欲情]] += B
;PALAM:抑鬱の上昇
UP:[[UP:抑鬱]] += C

;-------------------------------------------------
;快Ａのソース
;-------------------------------------------------
;Ａ敏感とＡ鈍感はここで処理
SIF TALENT:Ａ鈍感
	TIMES SOURCE:快Ａ , 0.50
SIF TALENT:Ａ敏感
	TIMES SOURCE:快Ａ , 2.00

A = SOURCE:快Ａ

;PALAM:欲情をみる
;快ＡはあまりPALAM:欲情では差が出ない
IF TFLAG:201 == 1
	TIMES A , 1.00
ELSEIF PALAM:欲情 < PALAMLV:1
	TIMES A , 0.60
ELSEIF PALAM:欲情 < PALAMLV:2
	TIMES A , 0.80
ELSEIF PALAM:欲情 < PALAMLV:3
	TIMES A , 1.00
ELSEIF PALAM:欲情 < PALAMLV:4
	TIMES A , 1.20
ELSEIF PALAM:欲情 >= PALAMLV:4
	TIMES A , 1.40
ENDIF

B = SOURCE:快Ａ

;ABL:欲望をみる
IF ABL:欲望 == 0
	TIMES B , 0.05
ELSEIF ABL:欲望 == 1
	TIMES B , 0.10
ELSEIF ABL:欲望 == 2
	TIMES B , 0.40
ELSEIF ABL:欲望 == 3
	TIMES B , 0.80
ELSEIF ABL:欲望 == 4
	TIMES B , 1.20
ELSEIF ABL:欲望 == 5
	TIMES B , 1.80
ELSE
	TIMES B , 2.00
ENDIF

;快感の否定、抑圧、抵抗
IF TALENT:抑圧 || TALENT:抵抗 || TALENT:快感の否定
	C = SOURCE:快Ａ / 3
	;ABL:欲望をみる
	IF ABL:欲望 == 0
		TIMES C , 1.00
	ELSEIF ABL:欲望 == 1
		TIMES C , 0.85
	ELSEIF ABL:欲望 == 2
		TIMES C , 0.70
	ELSEIF ABL:欲望 == 3
		TIMES C , 0.40
	ELSEIF ABL:欲望 == 4
		TIMES C , 0.30
	ELSEIF ABL:欲望 == 5
		TIMES C , 0.10
	ELSE
		C = 0
	ENDIF
ELSE
	C = 0
ENDIF

;尻穴狂い
IF TALENT:尻穴狂い
	TIMES A , 1.50
	TIMES B , 1.20
	TIMES C , 0.50
ENDIF

;淫肛
IF TALENT:淫肛
	TIMES A , 2.00
ENDIF

;PALAM:快Ａの上昇
UP:[[UP:快Ａ]] += A
;PALAM:欲情の上昇
UP:[[UP:欲情]] += B
;PALAM:屈服の上昇
UP:[[UP:屈服]] += B
;PALAM:抑鬱の上昇
UP:[[UP:抑鬱]] += C

;-------------------------------------------------
;快Ｂのソース
;-------------------------------------------------
;Ｂ敏感とＢ鈍感はここで処理
SIF TALENT:Ｂ鈍感
	TIMES SOURCE:快Ｂ , 0.50
SIF TALENT:Ｂ敏感
	TIMES SOURCE:快Ｂ , 2.00

;絶壁、貧乳、巨乳、爆乳はここで処理
IF TALENT:神乳
	TIMES SOURCE:快Ｖ , 2.50
ELSEIF TALENT:魔乳
	TIMES SOURCE:快Ｖ , 2.15
ELSEIF TALENT:超乳
	TIMES SOURCE:快Ｖ , 1.80
ELSEIF TALENT:絶壁
	TIMES SOURCE:快Ｖ , 1.50
ELSEIF TALENT:貧乳
	TIMES SOURCE:快Ｖ , 1.20
ELSEIF TALENT:巨乳
	TIMES SOURCE:快Ｖ , 0.90
ELSEIF TALENT:爆乳
	TIMES SOURCE:快Ｖ , 0.80
ENDIF

A = SOURCE:快Ｂ

;PALAM:欲情をみる
IF TFLAG:201 == 1
	TIMES A , 1.00
ELSEIF PALAM:欲情 < PALAMLV:1
	TIMES A , 0.50
ELSEIF PALAM:欲情 < PALAMLV:2
	TIMES A , 0.70
ELSEIF PALAM:欲情 < PALAMLV:3
	TIMES A , 1.00
ELSEIF PALAM:欲情 < PALAMLV:4
	TIMES A , 1.30
ELSEIF PALAM:欲情 >= PALAMLV:4
	TIMES A , 1.80
ENDIF

B = SOURCE:快Ｂ

;ABL:欲望をみる
IF ABL:欲望 == 0
	TIMES B , 0.10
ELSEIF ABL:欲望 == 1
	TIMES B , 0.15
ELSEIF ABL:欲望 == 2
	TIMES B , 0.20
ELSEIF ABL:欲望 == 3
	TIMES B , 0.25
ELSEIF ABL:欲望 == 4
	TIMES B , 0.30
ELSEIF ABL:欲望 == 5
	TIMES B , 0.40
ELSE
	TIMES B , 0.50
ENDIF

;快感の否定、抑圧、抵抗
IF TALENT:抑圧 || TALENT:抵抗 || TALENT:快感の否定
	C = SOURCE:快Ｂ / 3
	;ABL:欲望をみる
	IF ABL:欲望 == 0
		TIMES C , 1.00
	ELSEIF ABL:欲望 == 1
		TIMES C , 0.85
	ELSEIF ABL:欲望 == 2
		TIMES C , 0.70
	ELSEIF ABL:欲望 == 3
		TIMES C , 0.40
	ELSEIF ABL:欲望 == 4
		TIMES C , 0.30
	ELSEIF ABL:欲望 == 5
		TIMES C , 0.10
	ELSE
		C = 0
	ENDIF
ELSE
	C = 0
ENDIF

;乳狂い
IF TALENT:乳狂い
	TIMES A , 1.50
	TIMES B , 1.20
	TIMES C , 0.50
ENDIF

;淫乳
IF TALENT:淫乳
	TIMES A , 2.00
ENDIF

;PALAM:快Ｂの上昇
UP:[[UP:快Ｂ]] += A
;PALAM:欲情の上昇
UP:[[UP:欲情]] += B
;PALAM:抑鬱の上昇
UP:[[UP:抑鬱]] += C

;-------------------------------------------------
;同じコマンドの連続実行による上下の処理（快楽系）
;-------------------------------------------------
IF SELECTCOM == PREVCOM && TFLAG:201 != 1
	;UP:[[UP:快Ｃ]],1,2は絶頂に絡むので先に処理してある
	UP:[[UP:快Ｃ]] /= 2
	UP:[[UP:快Ｖ]] /= 2
	UP:[[UP:快Ａ]] /= 2
	UP:[[UP:快Ｂ]] /= 2
ENDIF

;-------------------------------------------------
;気力０による上下の処理（快楽系）
;-------------------------------------------------
IF BASE:気力 <= 0 && TFLAG:201 != 1
	;UP:[[UP:快Ｃ]],1,2は絶頂に絡むので先に処理してある
	UP:[[UP:快Ｃ]] /= 2
	UP:[[UP:快Ｖ]] /= 2
	UP:[[UP:快Ａ]] /= 2
	UP:[[UP:快Ｂ]] /= 2
ENDIF

;-------------------------------------------------
;相性による上下の処理（快楽系）
;-------------------------------------------------
R = NO:PLAYER
IF RELATION:R != 0 && TFLAG:201 != 1
	UP:[[UP:快Ｃ]] *= RELATION:R
	UP:[[UP:快Ｃ]] /= 100
	UP:[[UP:快Ｖ]] *= RELATION:R
	UP:[[UP:快Ｖ]] /= 100
	UP:[[UP:快Ａ]] *= RELATION:R
	UP:[[UP:快Ａ]] /= 100
	UP:[[UP:快Ｂ]] *= RELATION:R
	UP:[[UP:快Ｂ]] /= 100
ENDIF

;-------------------------------------------------
;素質などによる上下の処理（快楽系）
;-------------------------------------------------
CALL UP_TALENT_CVA_CHECK

;-------------------------------------------------
;愛液処理
;-------------------------------------------------
A = UP:[[UP:快Ｃ]] + UP:[[UP:快Ｖ]] + UP:[[UP:快Ａ]] + UP:[[UP:快Ｂ]]
;快Ｃ＋快Ｖ＋快Ａ＋快Ｂが合わせて100以上上昇ならその20%の液体のソースが加わる（オトコはダメ）
IF A > 100 && TALENT:オトコ == 0
	;濡れやすいと濡れにくいはここで処理
	SIF TALENT:濡れやすい
		TIMES A , 3.00
	SIF TALENT:濡れにくい
		TIMES A , 0.40
	SIF TALENT:170
		TIMES A , 0.10
	SOURCE:愛液分泌 += A / 5
ENDIF

;-------------------------------------------------
;絶頂処理
;-------------------------------------------------
C = 0
V = 0
A = 0
B = 0
						;****追加ここから****
M = 0
						;****追加ここまで****
;絶頂Ｃ
IF UP:[[UP:快Ｃ]] + PALAM:快Ｃ >= PALAMLV:4 * 32
	C = 9
						;****追加ここから****
	SIF TALENT:性魔術
		M += 9
						;****追加ここまで****
	DOWN:[[DOWN:快Ｃ]] = (PALAMLV:4 * 32 - 1000)
	PRINTL 最強絶頂Ｃ
ELSEIF UP:[[UP:快Ｃ]] + PALAM:快Ｃ >= PALAMLV:4 * 8
	C = 4
						;****追加ここから****
	SIF TALENT:性魔術
		M += 4
						;****追加ここまで****
	DOWN:[[DOWN:快Ｃ]] = (PALAMLV:4 * 8 - 1000)
	PRINTL 超絶頂Ｃ
ELSEIF UP:[[UP:快Ｃ]] + PALAM:快Ｃ >= PALAMLV:4 * 2
	C = 2
						;****追加ここから****
	SIF TALENT:性魔術
		M += 2
						;****追加ここまで****
	DOWN:[[DOWN:快Ｃ]] = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ｃ
ELSEIF UP:[[UP:快Ｃ]] + PALAM:快Ｃ >= PALAMLV:4
	C = 1
						;****追加ここから****
	SIF TALENT:性魔術
		M += 1
						;****追加ここまで****
	DOWN:[[DOWN:快Ｃ]] = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ｃ
ENDIF
;DOWN:0で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF UP:[[UP:快Ｃ]] + PALAM:快Ｃ - DOWN:[[DOWN:快Ｃ]] >= PALAMLV:4
	DOWN:[[DOWN:快Ｃ]] = UP:[[UP:快Ｃ]] + PALAM:快Ｃ - PALAMLV:4 + 1

;絶頂Ｖ
IF UP:[[UP:快Ｖ]] + PALAM:快Ｖ >= PALAMLV:4 * 32
	V = 9
						;****追加ここから****
	SIF TALENT:性魔術
		M += 9
						;****追加ここまで****
	DOWN:[[DOWN:快Ｖ]] = (PALAMLV:4 * 32 - 1000)
	PRINTL 最強絶頂Ｖ
ELSEIF UP:[[UP:快Ｖ]] + PALAM:快Ｖ >= PALAMLV:4 * 8
	V = 4
						;****追加ここから****
	SIF TALENT:性魔術
		M += 4
						;****追加ここまで****
	DOWN:[[DOWN:快Ｖ]] = (PALAMLV:4 * 8 - 1000)
	PRINTL 超絶頂Ｖ
ELSEIF UP:[[UP:快Ｖ]] + PALAM:快Ｖ >= PALAMLV:4 * 2
	V = 2
						;****追加ここから****
	SIF TALENT:性魔術
		M += 2
						;****追加ここまで****
	DOWN:[[DOWN:快Ｖ]] = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ｖ
ELSEIF UP:[[UP:快Ｖ]] + PALAM:快Ｖ >= PALAMLV:4
	V = 1
						;****追加ここから****
	SIF TALENT:性魔術
		M += 1
						;****追加ここまで****
	DOWN:[[DOWN:快Ｖ]] = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ｖ
ENDIF
;DOWN:1で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF UP:[[UP:快Ｖ]] + PALAM:快Ｖ - DOWN:[[DOWN:快Ｖ]] >= PALAMLV:4
	DOWN:[[DOWN:快Ｖ]] = UP:[[UP:快Ｖ]] + PALAM:快Ｖ - PALAMLV:4 + 1

;絶頂Ａ
IF UP:[[UP:快Ａ]] + PALAM:快Ａ >= PALAMLV:4 * 32
	A = 9
						;****追加ここから****
	SIF TALENT:性魔術
		M += 9
						;****追加ここまで****
	DOWN:[[DOWN:快Ａ]] = (PALAMLV:4 * 32 - 1000)
	PRINTL 最強絶頂Ａ
ELSEIF UP:[[UP:快Ａ]] + PALAM:快Ａ >= PALAMLV:4 * 8
	A = 4
						;****追加ここから****
	SIF TALENT:性魔術
		M += 4
						;****追加ここまで****
	DOWN:[[DOWN:快Ａ]] = (PALAMLV:4 * 8 - 1000)
	PRINTL 超絶頂Ａ
ELSEIF UP:[[UP:快Ａ]] + PALAM:快Ａ >= PALAMLV:4 * 2
	A = 2
						;****追加ここから****
	SIF TALENT:性魔術
		M += 2
						;****追加ここまで****
	DOWN:[[DOWN:快Ａ]] = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ａ
ELSEIF UP:[[UP:快Ａ]] + PALAM:快Ａ >= PALAMLV:4
	A = 1
						;****追加ここから****
	SIF TALENT:性魔術
		M += 1
						;****追加ここまで****
	DOWN:[[DOWN:快Ａ]] = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ａ
ENDIF
;DOWN:2で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF UP:[[UP:快Ａ]] + PALAM:快Ａ - DOWN:[[DOWN:快Ａ]] >= PALAMLV:4
	DOWN:[[DOWN:快Ａ]] = UP:[[UP:快Ａ]] + PALAM:快Ａ - PALAMLV:4 + 1

;絶頂Ｂ
IF UP:[[UP:快Ｂ]] + PALAM:快Ｂ >= PALAMLV:4 * 32
	B = 9
						;****追加ここから****
	SIF TALENT:性魔術
		M += 9
						;****追加ここまで****
	DOWN:[[DOWN:快Ｂ]] = (PALAMLV:4 * 32 - 1000)
	PRINTL 最強絶頂Ｂ
ELSEIF UP:[[UP:快Ｂ]] + PALAM:快Ｂ >= PALAMLV:4 * 8
	B = 4
						;****追加ここから****
	SIF TALENT:性魔術
		M += 4
						;****追加ここまで****
	DOWN:[[DOWN:快Ｂ]] = (PALAMLV:4 * 8 - 1000)
	PRINTL 超絶頂Ｂ
ELSEIF UP:[[UP:快Ｂ]] + PALAM:快Ｂ >= PALAMLV:4 * 2
	B = 2
						;****追加ここから****
	SIF TALENT:性魔術
		M += 2
						;****追加ここまで****
	DOWN:[[DOWN:快Ｂ]] = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ｂ
ELSEIF UP:[[UP:快Ｂ]] + PALAM:快Ｂ >= PALAMLV:4
	B = 1
						;****追加ここから****
	SIF TALENT:性魔術
		M += 1
						;****追加ここまで****
	DOWN:[[DOWN:快Ｂ]] = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ｂ
ENDIF
;DOWN:14で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF UP:[[UP:快Ｂ]] + PALAM:快Ｂ - DOWN:[[DOWN:快Ｂ]] >= PALAMLV:4
	DOWN:[[DOWN:快Ｂ]] = UP:[[UP:快Ｂ]] + PALAM:快Ｂ - PALAMLV:4 + 1

CALL ECST_CHECK

;精飲絶頂処理へ
CALL SEIIN_START

IF C && V && A && B
	PRINTL 四 重 絶 頂
	PRINTL (それぞれ8倍の珠が得られます)
	C *= 8
	V *= 8
	A *= 8
	B *= 8
						;****追加ここから****
	SIF TALENT:性魔術
		M *= 8
						;****追加ここまで****
ELSEIF C && V && A
	PRINTL Ｃ＆Ｖ＆Ａ絶頂
	PRINTL (それぞれ4倍の珠が得られます)
	C *= 4
	V *= 4
	A *= 4
						;****追加ここから****
	SIF TALENT:性魔術
		M *= 4
						;****追加ここまで****
ELSEIF B && V && A
	PRINTL Ｂ＆Ｖ＆Ａ絶頂
	PRINTL (それぞれ4倍の珠が得られます)
	B *= 4
	V *= 4
	A *= 4
						;****追加ここから****
	SIF TALENT:性魔術
		M *= 4
						;****追加ここまで****
ELSEIF C && B && A
	PRINTL Ｃ＆Ｂ＆Ａ絶頂
	PRINTL (それぞれ4倍の珠が得られます)
	C *= 4
	B *= 4
	A *= 4
						;****追加ここから****
	SIF TALENT:性魔術
		M *= 4
						;****追加ここまで****
ELSEIF C && V && B
	PRINTL Ｃ＆Ｖ＆Ｂ絶頂
	PRINTL (それぞれ4倍の珠が得られます)
	C *= 4
	V *= 4
	B *= 4
						;****追加ここから****
	SIF TALENT:性魔術
		M *= 4
						;****追加ここまで****
ELSEIF C && V
	PRINTL Ｃ＆Ｖ絶頂
	PRINTL (それぞれ2倍の珠が得られます)
	C *= 2
	V *= 2
						;****追加ここから****
	SIF TALENT:性魔術
		M *= 2
						;****追加ここまで****
ELSEIF C && A
	PRINTL Ｃ＆Ａ絶頂
	PRINTL (それぞれ2倍の珠が得られます)
	C *= 2
	A *= 2
						;****追加ここから****
	SIF TALENT:性魔術
		M *= 2
						;****追加ここまで****
ELSEIF V && A
	PRINTL Ｖ＆Ａ絶頂
	PRINTL (それぞれ2倍の珠が得られます)
	V *= 2
	A *= 2
						;****追加ここから****
	SIF TALENT:性魔術
		M *= 2
						;****追加ここまで****
ELSEIF C && B
	PRINTL Ｃ＆Ｂ絶頂
	PRINTL (それぞれ2倍の珠が得られます)
	C *= 2
	B *= 2
						;****追加ここから****
	SIF TALENT:性魔術
		M *= 2
						;****追加ここまで****
ELSEIF V && B
	PRINTL Ｖ＆Ｂ絶頂
	PRINTL (それぞれ2倍の珠が得られます)
	V *= 2
	B *= 2
						;****追加ここから****
	SIF TALENT:性魔術
		M *= 2
						;****追加ここまで****
ELSEIF A && B
	PRINTL Ａ＆Ｂ絶頂
	PRINTL (それぞれ2倍の珠が得られます)
	A *= 2
	B *= 2
						;****追加ここから****
	SIF TALENT:性魔術
		M *= 2
						;****追加ここまで****
ENDIF


IF C
	SOURCE:露出 += 500 * C
	SOURCE:屈従 += 200 * C
	IF TALENT:淫核
		LOSEBASE:体力 += 10
		LOSEBASE:気力 += 5
	ELSE
		LOSEBASE:体力 += 20
		LOSEBASE:気力 += 10
	ENDIF

	IF C == 2
		;屈服刻印１に相当
		SIF TFLAG:屈服刻印2 < 1
			TFLAG:屈服刻印2 = 1
	ENDIF
ENDIF
IF V
	SOURCE:露出 += 700 * V
	SOURCE:屈従 += 400 * V
	SOURCE:欲情 += 800 * V
	SOURCE:恭順 += 500 * V
	IF TALENT:淫壺
		LOSEBASE:体力 += 20
		LOSEBASE:気力 += 10
	ELSE
		LOSEBASE:体力 += 40
		LOSEBASE:気力 += 20
	ENDIF

	IF V == 1
		;屈服刻印１に相当
		SIF TFLAG:屈服刻印2 < 1
			TFLAG:屈服刻印2 = 1
	ELSEIF V == 2
		;屈服刻印２に相当
		SIF TFLAG:屈服刻印2 < 2
			TFLAG:屈服刻印2 = 2
	ENDIF
ENDIF
IF A
	SOURCE:露出 += 1200 * A
	SOURCE:屈従 += 4500 * A
	SOURCE:欲情 += 3500 * A
	SOURCE:恭順 += 1500 * A
	IF TALENT:淫肛
		LOSEBASE:体力 += 30
		LOSEBASE:気力 += 15
	ELSE
		LOSEBASE:体力 += 60
		LOSEBASE:気力 += 30
	ENDIF

	;屈服刻印３に相当
	SIF TFLAG:屈服刻印2 < 3
		TFLAG:屈服刻印2 = 3
ENDIF
IF B
	SOURCE:露出 += 500 * B
	SOURCE:屈従 += 200 * B
	IF TALENT:淫乳
		LOSEBASE:体力 += 10
		LOSEBASE:気力 += 5
	ELSE
		LOSEBASE:体力 += 20
		LOSEBASE:気力 += 10
	ENDIF

	IF B == 2
		;屈服刻印１に相当
		SIF TFLAG:屈服刻印2 < 1
			TFLAG:屈服刻印2 = 1
	ENDIF
ENDIF
;絶頂による欲望ＬＶアップ
L = 0
;Ｃ絶頂かＢ絶頂で欲望ＬＶ１
SIF C || B
	L = 1
;Ｖ絶頂で欲望ＬＶ２
SIF V
	L = 2
;Ａ絶頂か、Ｃ＆Ｂ＆Ｖ絶頂か、最強絶頂を含む二重絶頂で欲望ＬＶ３
SIF A || (C && B && V) || (C + B + V + A) >= 20
	L = 3
;四重絶頂か、最強絶頂を含むか超絶頂を２つ含む三重絶頂か、最強絶頂２つの二重絶頂で欲望ＬＶ４
SIF (C && B && V && A) || (C + B + V + A) >= 36
	L = 4
;最強絶頂を含むか超絶頂を２つ含むか超絶頂を１つと強絶頂を２つ含む四重絶頂か、最強絶頂を２つ含む三重絶頂で欲望ＬＶ５
SIF (C + B + V + A) >= 72
	L = 5
;最強絶頂４つの四重絶頂で欲望ＬＶ１０
SIF (C + B + V + A) >= 288
	L = 10
;【自制心】か【一線越えない】があると１下がる
SIF TALENT:自制心 || TALENT:一線越えない
	L -= 1

IF ABL:欲望 < L
	ABL:欲望 = L
	PRINTFORML そして%ABLNAME:[[ABL:欲望]]%がLV{L}になった
	;欲望の上昇による[抑圧][抵抗]の消滅をチェック
	SIF L >= 3
		CALL YOKUBO_UP_CHECK
ENDIF

;NOWEXにデータを入れる（絶頂時口上に使う）
NOWEX:0 = C
NOWEX:1 = V
NOWEX:2 = A
NOWEX:3 = B

;絶頂回数を増やす
EX:0 += C
EX:1 += V
EX:2 += A
EX:3 += B

;絶頂経験を増やす
EXP:絶頂経験 += C + V + A + B

						;****追加ここから****
SIF TALENT:性魔術
	EX:10 += M
						;****追加ここまで****
;-------------------------------------------------
;調教対象の射精チェック（ふたなり・オトコ）
;-------------------------------------------------
CALL TARGET_EJAC_CHECK

;-------------------------------------------------
;調教対象の噴乳チェック
;-------------------------------------------------
CALL TARGET_MILK_CHECK

;-------------------------------------------------
;主人による調教の経験値
;-------------------------------------------------
CALL MASTER_FLAG_CHECK

;-------------------------------------------------
;IWSシステムの処理
;-------------------------------------------------
;IWSシステムがオンの時は成長処理を行う
SIF FLAG:ＩＷＳなし > 0
	CALL CHECK_IWS

;-------------------------------------------------
;情愛のソース
;-------------------------------------------------
A = SOURCE:情愛
B = SOURCE:情愛

;ABL:従順をみる
IF ABL:信頼 == 0
	TIMES A , 0.10
ELSEIF ABL:信頼 == 1
	TIMES A , 0.25
ELSEIF ABL:信頼 == 2
	TIMES A , 0.40
ELSEIF ABL:信頼 == 3
	TIMES A , 0.60
ELSEIF ABL:信頼 == 4
	TIMES A , 0.80
ELSEIF ABL:信頼 == 5
	TIMES A , 1.00
ELSE
	TIMES A , 1.20
ENDIF

;ABL:奉仕精神をみる
IF ABL:奉仕精神 == 0
	TIMES A , 0.95
ELSEIF ABL:奉仕精神 == 1
	TIMES A , 1.00
ELSEIF ABL:奉仕精神 == 2
	TIMES A , 1.05
ELSEIF ABL:奉仕精神 == 3
	TIMES A , 1.10
ELSEIF ABL:奉仕精神 == 4
	TIMES A , 1.00
ELSEIF ABL:奉仕精神 == 5
	TIMES A , 1.10
ELSE
	TIMES A , 1.20
ENDIF

;ABL:欲望をみる
IF ABL:欲望 == 0
	TIMES B , 0.00
ELSEIF ABL:欲望 == 1
	TIMES B , 0.05
ELSEIF ABL:欲望 == 2
	TIMES B , 0.10
ELSEIF ABL:欲望 == 3
	TIMES B , 0.20
ELSEIF ABL:欲望 == 4
	TIMES B , 0.30
ELSEIF ABL:欲望 == 5
	TIMES B , 0.40
ELSE
	TIMES B , 0.50
ENDIF

;PALAM:恭順の上昇
UP:[[UP:恭順]] += A
;PALAM:欲情の上昇
UP:[[UP:欲情]] += B

;-------------------------------------------------
;性行動のソース
;-------------------------------------------------
A = SOURCE:性行動

;ABL:奉仕精神をみる
IF ABL:奉仕精神 == 0
	TIMES A , 0.60
ELSEIF ABL:奉仕精神 == 1
	TIMES A , 0.80
ELSEIF ABL:奉仕精神 == 2
	TIMES A , 1.00
ELSEIF ABL:奉仕精神 == 3
	TIMES A , 1.20
ELSEIF ABL:奉仕精神 == 4
	TIMES A , 1.40
ELSEIF ABL:奉仕精神 == 5
	TIMES A , 1.70
ELSE
	TIMES A , 2.00
ENDIF

;ABL:奉仕技術をみる
IF ABL:奉仕技術 == 0
	TIMES A , 0.95
ELSEIF ABL:奉仕技術 == 1
	TIMES A , 1.00
ELSEIF ABL:奉仕技術 == 2
	TIMES A , 1.05
ELSEIF ABL:奉仕技術 == 3
	TIMES A , 1.10
ELSEIF ABL:奉仕技術 == 4
	TIMES A , 1.00
ELSEIF ABL:奉仕技術 == 5
	TIMES A , 1.10
ELSE
	TIMES A , 1.20
ENDIF

;調教者が教師
SIF TALENT:PLAYER:プロデューサー
	TIMES A , 1.20

;抑圧か抵抗がある場合はPALAM:抑鬱が上がる
IF TALENT:抑圧 || TALENT:抵抗
	B = SOURCE:性行動 / 5
	;ABL:奉仕精神をみる
	IF ABL:奉仕精神 == 0
		TIMES B , 1.80
	ELSEIF ABL:奉仕精神 == 1
		TIMES B , 1.30
	ELSEIF ABL:奉仕精神 == 2
		TIMES B , 0.90
	ELSEIF ABL:奉仕精神 == 3
		TIMES B , 0.70
	ELSEIF ABL:奉仕精神 == 4
		TIMES B , 0.50
	ELSEIF ABL:奉仕精神 == 5
		TIMES B , 0.30
	ELSE
		TIMES B , 0.10
	ENDIF
ELSE
	B = 0
ENDIF

;PALAM:習得の上昇
UP:[[UP:習得]] += A
;PALAM:抑鬱の上昇
UP:[[UP:抑鬱]] += B

;-------------------------------------------------
;達成のソース
;-------------------------------------------------
A = SOURCE:達成

;ABL:従順をみる
IF ABL:信頼 == 0
	TIMES A , 0.50
ELSEIF ABL:信頼 == 1
	TIMES A , 0.80
ELSEIF ABL:信頼 == 2
	TIMES A , 1.00
ELSEIF ABL:信頼 == 3
	TIMES A , 1.20
ELSEIF ABL:信頼 == 4
	TIMES A , 1.40
ELSEIF ABL:信頼 == 5
	TIMES A , 1.60
ELSEIF ABL:信頼 == 6
	TIMES A , 1.80
ELSE
	TIMES A , 2.00
ENDIF

;ABL:奉仕精神をみる
IF ABL:奉仕精神 == 0
	TIMES A , 0.00
ELSEIF ABL:奉仕精神 == 1
	TIMES A , 0.40
ELSEIF ABL:奉仕精神 == 2
	TIMES A , 0.80
ELSEIF ABL:奉仕精神 == 3
	TIMES A , 1.20
ELSEIF ABL:奉仕精神 == 4
	TIMES A , 1.60
ELSEIF ABL:奉仕精神 == 5
	TIMES A , 2.00
ELSE
	TIMES A , 2.40
ENDIF

;ABL:奉仕技術をみる
IF ABL:奉仕技術 == 0
	TIMES A , 0.95
ELSEIF ABL:奉仕技術 == 1
	TIMES A , 1.00
ELSEIF ABL:奉仕技術 == 2
	TIMES A , 1.05
ELSEIF ABL:奉仕技術 == 3
	TIMES A , 1.10
ELSEIF ABL:奉仕技術 == 4
	TIMES A , 1.00
ELSEIF ABL:奉仕技術 == 5
	TIMES A , 1.10
ELSE
	TIMES A , 1.20
ENDIF

;PALAM:恭順の上昇
UP:[[UP:恭順]] += A

;-------------------------------------------------
;痛覚のソース
;-------------------------------------------------
A = SOURCE:痛覚
B = SOURCE:痛覚
C = SOURCE:痛覚
D = SOURCE:痛覚

;ABL:従順をみる
IF ABL:信頼 == 0
	TIMES B , 0.80
	TIMES C , 0.80
ELSEIF ABL:信頼 == 1
	TIMES B , 0.70
	TIMES C , 0.60
ELSEIF ABL:信頼 == 2
	TIMES B , 0.55
	TIMES C , 0.50
ELSEIF ABL:信頼 == 3
	TIMES B , 0.45
	TIMES C , 0.40
ELSEIF ABL:信頼 == 4
	TIMES B , 0.35
	TIMES C , 0.20
ELSEIF ABL:信頼 == 5
	TIMES B , 0.25
	TIMES C , 0.05
ELSE
	TIMES B , 0.15
	TIMES C , 0.00
ENDIF

;ABL:マゾっ気をみる
IF ABL:マゾっ気 == 0
	TIMES C , 1.00
	TIMES D , 0.00
ELSEIF ABL:マゾっ気 == 1
	TIMES C , 0.80
	TIMES D , 0.10
ELSEIF ABL:マゾっ気 == 2
	TIMES C , 0.50
	TIMES D , 0.20
ELSEIF ABL:マゾっ気 == 3
	TIMES C , 0.30
	TIMES D , 0.30
ELSEIF ABL:マゾっ気 == 4
	TIMES C , 0.10
	TIMES D , 0.45
ELSEIF ABL:マゾっ気 == 5
	TIMES C , 0.05
	TIMES D , 0.60
ELSE
	TIMES C , 0.00
	TIMES D , 0.75
ENDIF

;調教者のABL:サドっ気をみる
IF ABL:PLAYER:サドっ気 == 0
	TIMES D , 1.00
ELSEIF ABL:PLAYER:サドっ気 == 1
	TIMES D , 1.10
ELSEIF ABL:PLAYER:サドっ気 == 2
	TIMES D , 1.20
ELSEIF ABL:PLAYER:サドっ気 == 3
	TIMES D , 1.30
ELSEIF ABL:PLAYER:サドっ気 == 4
	TIMES D , 1.40
ELSEIF ABL:PLAYER:サドっ気 == 5
	TIMES D , 1.50
ELSE
	TIMES D , 1.60
ENDIF

;マゾ
SIF TALENT:マゾ
	TIMES D , 2.00

;調教者がサド
SIF TALENT:PLAYER:サド
	TIMES D , 2.00

;痛みに弱い・強い
IF TALENT:痛みに弱い
	TIMES A , 1.50
	TIMES D , 4.00
ELSEIF TALENT:痛みに強い
	TIMES A , 0.80
	TIMES D , 0.80
ENDIF

;忍者
IF TALENT:感情乏しい
	TIMES A , 0.50
	TIMES B , 0.50
	TIMES D , 0.50
ENDIF

;助手によるプレイ
SIF ASSIPLAY
	TIMES C , 0.40

;PALAM:苦痛の上昇
UP:[[UP:苦痛]] += A
;PALAM:恐怖の上昇
UP:[[UP:恐怖]] += B
;PALAM:反感の上昇
UP:[[UP:反感]] += C
;PALAM:欲情の上昇
;マゾっ気があるとPALAM:欲情も上がる
;そのとき調教者が【サド】だと効果的
UP:[[UP:欲情]] += D

;-------------------------------------------------
;中毒充足のソース
;-------------------------------------------------
A = SOURCE:中毒充足
B = SOURCE:中毒充足

;ABL:欲望を見る
IF ABL:欲望 == 0
	TIMES A , 0.10
	TIMES B , 0.20
ELSEIF ABL:欲望 == 1
	TIMES A , 0.15
	TIMES B , 0.30
ELSEIF ABL:欲望 == 2
	TIMES A , 0.20
	TIMES B , 0.40
ELSEIF ABL:欲望 == 3
	TIMES A , 0.25
	TIMES B , 0.50
ELSEIF ABL:欲望 == 4
	TIMES A , 0.30
	TIMES B , 0.60
ELSEIF ABL:欲望 == 5
	TIMES A , 0.35
	TIMES B , 0.70
ELSEIF ABL:欲望 == 6
	TIMES A , 0.40
	TIMES B , 0.80
ELSEIF ABL:欲望 == 7
	TIMES A , 0.45
	TIMES B , 0.90
ELSE
	TIMES A , 0.50
	TIMES B , 1.00
ENDIF

;PALAM:恭順の上昇
UP:[[UP:恭順]] += A
;PALAM:欲情の上昇
UP:[[UP:欲情]] += B

;-------------------------------------------------
;不潔のソース
;-------------------------------------------------
A = SOURCE:不潔
B = SOURCE:不潔

;ABL:従順をみる
IF ABL:信頼 == 0
	TIMES A , 0.60
	TIMES B , 1.00
ELSEIF ABL:信頼 == 1
	TIMES A , 0.40
	TIMES B , 0.80
ELSEIF ABL:信頼 == 2
	TIMES A , 0.25
	TIMES B , 0.60
ELSEIF ABL:信頼 == 3
	TIMES A , 0.10
	TIMES B , 0.30
ELSEIF ABL:信頼 == 4
	TIMES A , 0.00
	TIMES B , 0.10
ELSE
	TIMES A , 0.00
	TIMES B , 0.00
ENDIF

;PALAM:反感の上昇
UP:[[UP:反感]] += A
;PALAM:不快の上昇
UP:[[UP:不快]] += B

;-------------------------------------------------
;液体追加のソース
;-------------------------------------------------
A = SOURCE:液体追加

UP:[[UP:潤滑]] += A

;-------------------------------------------------
;愛液分泌のソース
;-------------------------------------------------
A = SOURCE:愛液分泌

UP:[[UP:潤滑]] += A

;-------------------------------------------------
;欲情追加のソース
;-------------------------------------------------
A = SOURCE:欲情

UP:[[UP:欲情]] += A

;-------------------------------------------------
;露出のソース
;-------------------------------------------------
;恥じらいと恥薄いはここで処理
SIF TALENT:恥じらい
	TIMES SOURCE:露出 , 2.00
SIF TALENT:恥薄い
	TIMES SOURCE:露出 , 0.50

;潤滑アップの50％を露出のソースに加える
;ただし液体追加のソースのぶんは引く
SOURCE:露出 += (UP:[[UP:潤滑]]-SOURCE:液体追加) / 2

A = SOURCE:露出
B = SOURCE:露出
C = SOURCE:露出

;ABL:露出癖をみる
IF ABL:露出癖 == 0
	TIMES A , 0.00
	TIMES C , 1.00
ELSEIF ABL:露出癖 == 1
	TIMES A , 0.10
	TIMES C , 0.90
ELSEIF ABL:露出癖 == 2
	TIMES A , 0.20
	TIMES C , 0.70
ELSEIF ABL:露出癖 == 3
	TIMES A , 0.40
	TIMES C , 0.50
ELSEIF ABL:露出癖 == 4
	TIMES A , 0.60
	TIMES C , 0.30
ELSEIF ABL:露出癖 == 5
	TIMES A , 0.80
	TIMES C , 0.10
ELSE
	TIMES A , 1.00
	TIMES C , 0.00
ENDIF

;PALAM:恥情をみる
;一度に恥を掻けば掻くほど羞恥心は減っていく
IF PALAM:恥情 < PALAMLV:1
	TIMES B , 1.00
ELSEIF PALAM:恥情 < PALAMLV:2
	TIMES B , 0.90
ELSEIF PALAM:恥情 < PALAMLV:3
	TIMES B , 0.70
ELSEIF PALAM:恥情 < PALAMLV:4
	TIMES B , 0.50
ELSEIF PALAM:恥情 >= PALAMLV:4
	TIMES B , 0.30
ENDIF

;ABL:従順をみる
IF ABL:信頼 == 0
	TIMES C , 0.50
ELSEIF ABL:信頼 == 1
	TIMES C , 0.30
ELSEIF ABL:信頼 == 2
	TIMES C , 0.15
ELSEIF ABL:信頼 == 3
	TIMES C , 0.05
ELSE
	TIMES C , 0.00
ENDIF

;PALAM:欲情の上昇
UP:[[UP:欲情]] += A
;PALAM:恥情の上昇
UP:[[UP:恥情]] += B
;PALAM:反感の上昇
UP:[[UP:反感]] += C

;-------------------------------------------------
;屈従のソース
;-------------------------------------------------
A = SOURCE:屈従
B = SOURCE:屈従

;ABL:従順をみる
IF ABL:信頼 == 0
	TIMES A , 0.12
	TIMES B , 0.50
ELSEIF ABL:信頼 == 1
	TIMES A , 0.10
	TIMES B , 0.80
ELSEIF ABL:信頼 == 2
	TIMES A , 0.05
	TIMES B , 1.00
ELSEIF ABL:信頼 == 3
	TIMES A , 0.02
	TIMES B , 1.10
ELSEIF ABL:信頼 == 4
	TIMES A , 0.00
	TIMES B , 1.20
ELSEIF ABL:信頼 == 5
	TIMES A , 0.00
	TIMES B , 1.30
ELSEIF ABL:信頼 == 6
	TIMES A , 0.00
	TIMES B , 1.40
ELSE
	TIMES A , 0.00
	TIMES B , 1.50
ENDIF

;ABL:獣姦中毒をみる
IF ABL:噴乳中毒 == 0
	TIMES B , 1.00
ELSEIF ABL:噴乳中毒 == 1
	TIMES B , 1.10
ELSEIF ABL:噴乳中毒 == 2
	TIMES B , 1.20
ELSEIF ABL:噴乳中毒 == 3
	TIMES B , 1.50
ELSEIF ABL:噴乳中毒 == 4
	TIMES B , 2.00
ELSEIF ABL:噴乳中毒 == 5
	TIMES B , 3.00
ELSE
	TIMES B , 4.00
ENDIF

;PALAM:抑鬱の上昇
UP:[[UP:抑鬱]] += A
;PALAM:屈服の上昇
UP:[[UP:屈服]] += B

;-------------------------------------------------
;逸脱のソース
;-------------------------------------------------
;好奇心と保守的はここで処理
SIF TALENT:好奇心
	TIMES SOURCE:逸脱 , 0.30
SIF TALENT:保守的
	TIMES SOURCE:逸脱 , 3.00

A = SOURCE:逸脱

;ABL:従順をみる
IF ABL:信頼 == 0
	TIMES A , 1.00
ELSEIF ABL:信頼 == 1
	TIMES A , 0.80
ELSEIF ABL:信頼 == 2
	TIMES A , 0.70
ELSEIF ABL:信頼 == 3
	TIMES A , 0.40
ELSEIF ABL:信頼 == 4
	TIMES A , 0.20
ELSE
	TIMES A , 0.00
ENDIF

;ABL:欲望をみる
IF ABL:欲望 == 0
	TIMES A , 0.90
ELSEIF ABL:欲望 == 1
	TIMES A , 0.70
ELSEIF ABL:欲望 == 2
	TIMES A , 0.50
ELSEIF ABL:欲望 == 3
	TIMES A , 0.30
ELSEIF ABL:欲望 == 4
	TIMES A , 0.10
ELSE
	TIMES A , 0.00
ENDIF

;PALAM:反感の上昇
UP:[[UP:反感]] += A

;-------------------------------------------------
;反感追加のソース
;-------------------------------------------------
A = SOURCE:反感

;PALAM:反感の上昇
UP:[[UP:反感]] += A

;-------------------------------------------------
;恭順追加のソース
;-------------------------------------------------
A = SOURCE:恭順

;PALAM:恭順の上昇
UP:[[UP:恭順]] += A

;-------------------------------------------------
;素質などによる上下の処理
;-------------------------------------------------
CALL UP_TALENT_CHECK

;-------------------------------------------------
;相性による上下の処理
;-------------------------------------------------
R = NO:PLAYER
IF RELATION:R != 0
	;PRINTFORML ＜相性{RELATION:R/100}.{RELATION:R%100}倍＞

	UP:[[UP:恭順]] *= RELATION:R
	UP:[[UP:恭順]] /= 100
	UP:[[UP:欲情]] *= RELATION:R
	UP:[[UP:欲情]] /= 100
	UP:[[UP:習得]] *= RELATION:R
	UP:[[UP:習得]] /= 100
	UP:[[UP:反感]] *= 100
	UP:[[UP:反感]] /= RELATION:R
	UP:[[UP:不快]] *= 100
	UP:[[UP:不快]] /= RELATION:R
	UP:[[UP:抑鬱]] *= 100
	UP:[[UP:抑鬱]] /= RELATION:R
ENDIF

;-------------------------------------------------
;同じコマンドの連続実行による上下の処理
;-------------------------------------------------
IF SELECTCOM == PREVCOM
	;UP:[[UP:快Ｃ]],1,2は絶頂に絡むので先に処理してある
	;PRINTL ＜同一コマンド連続実行＞
	UP:[[UP:恭順]] /= 2
	UP:[[UP:欲情]] /= 2
	UP:[[UP:屈服]] /= 2
	UP:[[UP:習得]] /= 2
	UP:[[UP:恥情]] /= 2
ENDIF

;「前回のコマンド」をTFLAG:59「前々回のコマンド」に入力
TFLAG:前々回のコマンド = PREVCOM
;今回のコマンドを「前回のコマンド」とする
;PREVCOM = SELECTCOM

;前回の調教者が助手か主人か
;IF ASSIPLAY
	;TFLAG:前回の調教者が助手 == 1
;ELSE
	;TFLAG:前回の調教者が助手 == 0
;ENDIF

;-------------------------------------------------
;気力０による上下の処理
;-------------------------------------------------

LOCAL = ABL:欲望 * 20
LOCAL:1 = LOSEBASE:体力 * 2
LOCAL:3 = LOCAL:1 - LOCAL
SIF LOCAL:3 <= 50
	LOCAL:3 = 50

IF BASE:気力 <= 0
	;UP:[[UP:快Ｃ]],1,2は絶頂に絡むので先に処理してある
	UP:[[UP:潤滑]] /= 2
	UP:[[UP:恭順]] /= 2
	UP:[[UP:欲情]] /= 2
	UP:[[UP:習得]] /= 2
	UP:[[UP:苦痛]] /= 2
	UP:[[UP:抑鬱]] /= 2
	LOSEBASE:体力 += LOCAL:3
	LOSEBASE:体力 += 80
ENDIF

;-------------------------------------------------
;調教対象の失神チェック
;-------------------------------------------------
CALL PASSOUT_CHECK
;野外プレイ中の失神処理
SIF TEQUIP:野外プレイ && TFLAG:失神中終了 > 0
	CALL PASSOUT_OUTDOOR

;-------------------------------------------------
;苦痛からくる体力・気力の減少
;-------------------------------------------------
D = UP:[[UP:苦痛]]/16
;ABL:マゾっ気をみる
IF ABL:マゾっ気 == 0
	TIMES D , 1.00
ELSEIF ABL:マゾっ気 == 1
	TIMES D , 0.95
ELSEIF ABL:マゾっ気 == 2
	TIMES D , 0.90
ELSEIF ABL:マゾっ気 == 3
	TIMES D , 0.80
ELSEIF ABL:マゾっ気 == 4
	TIMES D , 0.65
ELSE
	TIMES D , 0.50
ENDIF

;痛みに弱い
SIF TALENT:痛みに弱い
	TIMES D , 1.20
;痛みに強い
SIF TALENT:痛みに強い
	TIMES D , 0.80

LOSEBASE:体力 += D
LOSEBASE:気力 += D

						;****触手中毒パッチ追加ここから****
;-------------------------------------------------
;触手中毒による体力・気力の減少軽減
;-------------------------------------------------
IF TEQUIP:触手召喚
	IF ABL:触手中毒 == 0
		TIMES LOSEBASE:体力 , 1.00
		TIMES LOSEBASE:気力 , 1.00
	ELSEIF ABL:触手中毒 == 1
		TIMES LOSEBASE:体力 , 1.00
		TIMES LOSEBASE:気力 , 0.95
	ELSEIF ABL:触手中毒 == 2
		TIMES LOSEBASE:体力 , 0.95
		TIMES LOSEBASE:気力 , 0.95
	ELSEIF ABL:触手中毒 == 3
		TIMES LOSEBASE:体力 , 0.95
		TIMES LOSEBASE:気力 , 0.90
	ELSEIF ABL:触手中毒 == 4
		TIMES LOSEBASE:体力 , 0.90
		TIMES LOSEBASE:気力 , 0.90
	ELSEIF ABL:触手中毒 == 5
		TIMES LOSEBASE:体力 , 0.80
		TIMES LOSEBASE:気力 , 0.80
	ELSEIF ABL:触手中毒 == 6
		TIMES LOSEBASE:体力 , 0.75
		TIMES LOSEBASE:気力 , 0.75
	ELSEIF ABL:触手中毒 == 7
		TIMES LOSEBASE:体力 , 0.70
		TIMES LOSEBASE:気力 , 0.70
	ELSEIF ABL:触手中毒 == 8
		TIMES LOSEBASE:体力 , 0.60
		TIMES LOSEBASE:気力 , 0.60
	ELSEIF ABL:触手中毒 == 9
		TIMES LOSEBASE:体力 , 0.50
		TIMES LOSEBASE:気力 , 0.50
	ELSEIF ABL:触手中毒 >= 10
		TIMES LOSEBASE:体力 , 0.40
		TIMES LOSEBASE:気力 , 0.40
	ENDIF
ENDIF
						;****触手中毒パッチ追加ここまで****
;-------------------------------------------------
;体力・気力の減少
;-------------------------------------------------
BASE:体力 -= LOSEBASE:体力
BASE:気力 -= LOSEBASE:気力

IF BASE:気力 <= 0
	VARSET LOCAL, 0
	IF TFLAG:気力回復 == 0 && TALENT:ド根性 == 1
		LOCAL = MAXBASE:気力
		LOCAL /= 2
		PRINTL
		PRINTFORML 疲労の色が濃い%CALLNAME:TARGET%にここで指導を止めるかどうか尋ねたが、
		PRINTFORML %CALLNAME:TARGET%は気力を奮い立たせて指導の続行を申し出てきた…
		PRINTFORMW 《%CALLNAME:TARGET%の気力が{LOCAL}回復した》
		BASE:気力 = LOCAL
		TFLAG:気力回復 = 1
	ENDIF
ENDIF

;-------------------------------------------------
;指しっぱなし判定 TFLAG60
;-------------------------------------------------
TFLAG:挿しっぱなし = 0
IF SELECTCOM == [[TRAIN:正常位]] || SELECTCOM == [[TRAIN:後背位]] || SELECTCOM == [[TRAIN:対面座位]] || SELECTCOM == [[TRAIN:背面座位]] || SELECTCOM == [[TRAIN:正常位アナル]] || SELECTCOM == [[TRAIN:後背位アナル]] || SELECTCOM == [[TRAIN:対面座位アナル]] || SELECTCOM == [[TRAIN:背面座位アナル]] || SELECTCOM == [[TRAIN:騎乗位]] || SELECTCOM == [[TRAIN:騎乗位アナル]] || SELECTCOM == [[TRAIN:会話する]] || SELECTCOM == [[TRAIN:Ｇスポ責め]] || SELECTCOM == [[TRAIN:子宮口責め]] || SELECTCOM == [[TRAIN:正常位キス]] || SELECTCOM == [[TRAIN:正常位胸愛撫]] || SELECTCOM == [[TRAIN:正常位ＳＰ]] || SELECTCOM == [[TRAIN:後背位胸愛撫]] || SELECTCOM == [[TRAIN:後背位スパンキング]] || SELECTCOM == [[TRAIN:立ちバック]] || SELECTCOM == [[TRAIN:後背位ＳＰ]]
	SIF TFLAG:セックスで射精 == 0 || PALAM:欲情 >= PALAMLV:4
		TFLAG:挿しっぱなし = 1
ENDIF

;-------------------------------------------------
;コンドームの使用チェック（調教対象）
;-------------------------------------------------
;コンドームを付けた調教対象が射精
IF TEQUIP:調教対象コンドーム && TFLAG:調教対象が射精
	PRINTFORML コンドームの中に射精（%CALLNAME:TARGET%）
	TEQUIP:調教対象コンドーム = 0
	TFLAG:調教対象が射精 = 0
ENDIF

;-------------------------------------------------
;膣内射精のチェック
;-------------------------------------------------
IF TFLAG:V経験を伴うコマンド
	;獣姦で膣内射精
	IF TEQUIP:獣姦プレイ && TFLAG:犬が射精
		CFLAG:TARGET:獣奴膣内精子量 += TFLAG:犬が射精
	;助手が膣内射精	
	ELSEIF ASSIPLAY && TFLAG:セックスで射精
		CFLAG:TARGET:助奴膣内精子量 += TFLAG:セックスで射精
	;主人が膣内射精	
	ELSEIF TFLAG:セックスで射精
		CFLAG:TARGET:主奴膣内精子量 += TFLAG:セックスで射精
	ENDIF
;奴隷が助手に膣内射精	
ELSEIF SELECTCOM == [[TRAIN:助手を犯させる]] && ASSI >= 1 && TFLAG:調教対象が射精
	CFLAG:TARGET:奴助膣内精子量 += TFLAG:調教対象が射精
ENDIF

;-------------------------------------------------
;テキストの表示
;-------------------------------------------------
CALL TRAIN_MESSAGE_A

;-------------------------------------------------
;失神テキストの表示
;-------------------------------------------------
;そのままでは見にくいので全角空白で改行を入れてみる
IF TFLAG:失神中終了 < 1
		CALL PASSOUT_TEXT
ELSEIF TFLAG:失神中終了 >= 1
	CALL PASSOUT_TEXT
	SIF TFLAG:恐怖強 == 2 || TFLAG:複数強絶頂 == 2 || TFLAG:苦痛強 == 2
		CALL PASSOUT_PALAM_CHECK
	IF TFLAG:恐怖強 == 3 || TFLAG:複数強絶頂 == 3 || TFLAG:苦痛強 == 3
		CALL PASSOUT_PALAM_UP
		CALL MARK_GOT_CHECK
		SIF FLAG:口上使用 > 0
			CALL KOJO_MESSAGE_MARKCNG
	ENDIF
ENDIF

;--------------------------------------------------------
;絶頂時のおもらし処理
;--------------------------------------------------------
CALL PISSING_ECST_CHECK

;-------------------------------------------------
;パラメータ変動による口上
;-------------------------------------------------
SIF FLAG:口上使用 > 0
	CALL KOJO_MESSAGE_PALAMCNG

;-------------------------------------------------
;刻印取得のチェック
;-------------------------------------------------
CALL MARK_GOT_CHECK
;刻印取得による口上
SIF FLAG:口上使用 > 0
	CALL KOJO_MESSAGE_MARKCNG

;-------------------------------------------------
;嗜虐快楽経験、被虐快楽経験、奉仕快楽経験のチェック
;-------------------------------------------------
CALL EXP_GOT_CHECK

;-------------------------------------------------
;[即落ち]のチェック
;-------------------------------------------------
CALL SOKUOCHI_CHECK

DRAWLINE

;-------------------------------------------------
;調教ソースの表示
;-------------------------------------------------
CALL SHOW_SOURCE

;-------------------------------------------------
;数値変動の表示
;-------------------------------------------------
;相性
R = NO:PLAYER
						;****相性表示修正ここから****
IF RELATION:R != 0
	IF RELATION:R%100 > 9
		PRINTFORML ＜相性{RELATION:R/100}.{RELATION:R%100}倍＞
	ELSE
		PRINTFORML ＜相性{RELATION:R/100}.0{RELATION:R%100}倍＞
	ENDIF
ENDIF
						;****相性表示修正ここまで****
;同じコマンドの連続実行
SIF SELECTCOM == PREVCOM
	PRINTL ＜同一コマンド連続実行＞

;今回のコマンドを「前回のコマンド」とする
PREVCOM = SELECTCOM

;前回の調教者が助手か主人か
IF ASSIPLAY
	TFLAG:前回の調教者が助手 = 1
ELSE
	TFLAG:前回の調教者が助手 = 0
ENDIF

;体力・気力の減少量を表示
IF BASE:体力 > 0 && LOSEBASE:体力 > 0
	CALL LOSELIFE_BAR
	PRINTFORM  -{LOSEBASE:体力} 
	SIF BASE:体力 < 500
		PRINT ★瀕死★
	PRINTL 
ENDIF
IF BASE:気力 > 0 && LOSEBASE:気力 > 0
	CALL LOSEVITAL_BAR
	PRINTFORML  -{LOSEBASE:気力} 
ELSEIF BASE:気力 < 1
	PRINTL  気力[................................] ★気力０★ 
ENDIF

;-------------------------------------------------
;パラメータの上昇＆表示（DOWNもここで）
;-------------------------------------------------
CALL PALAM_UP_CHECK

;△ここで一旦とめることができるようにしたい。こんふぃぐ？調教メニュー時は無視で
;IF 一回ごと停止させたい
;FORCEWAIT
;ENDIF

;-------------------------------------------------
;調教ソースの表示（DOWNもここで）
;-------------------------------------------------
@SHOW_SOURCE
;PRINTL 　
SIF SOURCE:快Ｃ > 0
	PRINTFORM 快Ｃ({SOURCE:快Ｃ})
SIF SOURCE:快Ｖ > 0
	PRINTFORM 快Ｖ({SOURCE:快Ｖ})
SIF SOURCE:快Ａ > 0
	PRINTFORM 快Ａ({SOURCE:快Ａ})
SIF SOURCE:快Ｂ > 0
	PRINTFORM 快Ｂ({SOURCE:快Ｂ})
SIF SOURCE:情愛 > 0
	PRINTFORM 情愛({SOURCE:情愛})
SIF SOURCE:性行動 > 0
	PRINTFORM 性行動({SOURCE:性行動})
SIF SOURCE:達成 > 0
	PRINTFORM 達成感({SOURCE:達成})
SIF SOURCE:痛覚 > 0
	PRINTFORM 痛み({SOURCE:痛覚})
SIF SOURCE:中毒充足 > 0
	PRINTFORM 中毒充足({SOURCE:中毒充足})
SIF SOURCE:不潔 > 0
	PRINTFORM 不潔({SOURCE:不潔})
SIF SOURCE:愛液分泌 > 0
	PRINTFORM 愛液分泌({SOURCE:愛液分泌})
SIF SOURCE:液体追加 > 0
	PRINTFORM 液体追加({SOURCE:液体追加})
SIF SOURCE:欲情 > 0
	PRINTFORM 欲情追加({SOURCE:欲情})
SIF SOURCE:恭順 > 0
	PRINTFORM 恭順追加({SOURCE:恭順})
SIF SOURCE:露出 > 0
	PRINTFORM 露出({SOURCE:露出})
SIF SOURCE:屈従 > 0
	PRINTFORM 屈従({SOURCE:屈従})
SIF SOURCE:逸脱 > 0
	PRINTFORM 逸脱({SOURCE:逸脱})
SIF SOURCE:反感 > 0
	PRINTFORM 反感追加({SOURCE:反感})
PRINTL 　
;
;
;
;-------------------------------------------------
;パラメータの上昇＆表示（UPCHECKと交換）
;-------------------------------------------------
@PALAM_UP_CHECK
REPEAT 15
	IF COUNT <= 2
		C = COUNT
	ELSEIF COUNT == 3
		C = 14
	ELSE
		C = COUNT - 1
	ENDIF
	IF UP:C > 0 || DOWN:C > 0
		PRINTFORM %PALAMNAME:C%
		N = PALAM:C
		CALL FIGURE_INDENT_2
		PRINTFORM {PALAM:C}
		IF UP:C > 0
			PRINTFORM +
			N = UP:C
			CALL FIGURE_INDENT_2
			PRINTFORM {UP:C}
		ELSE
			PRINT        
		ENDIF
		IF DOWN:C > 0
			PRINTFORM -
			N = DOWN:C
			CALL FIGURE_INDENT_2
			PRINTFORM {DOWN:C}
		ELSE
			PRINT        
		ENDIF
		PRINTFORM =
		N = PALAM:C + UP:C - DOWN:C
		CALL FIGURE_INDENT_2
		PRINTFORM {PALAM:C + UP:C - DOWN:C}
		
		PALAM:C += UP:C
		PALAM:C -= DOWN:C

		;CALL PALAM_MESSAGE
		PRINTL 
	ENDIF
	SIF C == 14 && (UP:[[UP:快Ｃ]] > 0 || UP:[[UP:快Ｖ]] > 0 || UP:[[UP:快Ａ]] > 0 || UP:[[UP:快Ｂ]] > 0) 
		PRINTL -------------------------------
	SIF C == 3 && UP:[[UP:潤滑]] > 0
		PRINTL -------------------------------
	SIF C == 10
		PRINTL -------------------------------
REND

;
@PALAM_MESSAGE
;快Ｃ、快Ｖ、快Ａ、快Ｂは絶頂で大きく増減するので、あまりメッセージを出す意味はない
;潤滑
IF C == 3
	IF PALAM:C < PALAMLV:2
		PRINT （あまり濡れていません）
	ELSEIF PALAM:C < PALAMLV:4
		PRINT （程よく濡れています）
	ELSE
		PRINT （充分に濡れています）
	ENDIF
;恭順
ELSEIF C == 4
	IF PALAM:C < PALAMLV:1
		PRINT （好意をもっていません）
	ELSEIF PALAM:C < PALAMLV:4
		PRINT （好意を抱きつつあります）
	ELSE
		PRINT （信頼を寄せています）
	ENDIF
;欲情
ELSEIF C == 5
	IF PALAM:C < PALAMLV:1
		PRINT （気持ちが乗っていません）
	ELSEIF PALAM:C < PALAMLV:4
		PRINT （発情しつつあります）
	ELSE
		PRINT （快楽の虜になっています）
	ENDIF
;屈服
ELSEIF C == 6
	IF PALAM:C < PALAMLV:2
		PRINT （まだ屈する気はないようです）
	ELSEIF PALAM:C < PALAMLV:4
		PRINT （やや弱気になっています）
	ELSE
		PRINT （心まで犯されています）
	ENDIF
;習得
ELSEIF C == 7
	IF PALAM:C < PALAMLV:1
		PRINT （よくわからないようです）
	ELSEIF PALAM:C < PALAMLV:4
		PRINT （悦ばせ方を学びつつあります）
	ELSE
		PRINT （充分にコツをつかんだようです）
	ENDIF
;恥情
ELSEIF C == 8
	IF PALAM:C < PALAMLV:1
		PRINT （恥ずかしさは感じていません）
	ELSEIF PALAM:C < PALAMLV:3
		PRINT （恥じらいを感じています）
	ELSEIF PALAM:C < PALAMLV:4
		PRINT （強い羞恥心を感じています）
	ELSE
		PRINT （死にたいぐらい恥ずかしがっています）
	ENDIF
;苦痛
ELSEIF C == 9
	IF PALAM:C < PALAMLV:1
		PRINT （痛みは感じていません）
	ELSEIF PALAM:C < PALAMLV:3
		PRINT （少し痛がっています）
	ELSEIF PALAM:C < PALAMLV:4
		PRINT （痛くてたまらないようです）
	ELSE
		PRINT （気が遠くなるほどの痛みです）
	ENDIF
;恐怖
ELSEIF C == 10
	IF PALAM:C < PALAMLV:1
		PRINT （平然としています）
	ELSEIF PALAM:C < PALAMLV:3
		PRINT （やや怯えています）
	ELSEIF PALAM:C < PALAMLV:4
		PRINT （怖くてたまらないようです）
	ELSE
		PRINT （気が狂いそうなほどの恐怖です）
	ENDIF
;反感
ELSEIF C == 11
	IF PALAM:C < PALAMLV:1
		PRINT （嫌がられてはいません）
	ELSEIF PALAM:C < PALAMLV:2
		PRINT （少し嫌がっています）
	ELSEIF PALAM:C < PALAMLV:3
		PRINT （嫌われています）
	ELSEIF PALAM:C < PALAMLV:4
		PRINT （強い憎悪を感じます）
	ELSE
		PRINT （殺意すら抱いています）
	ENDIF
;不快
ELSEIF C == 12
	IF PALAM:C < PALAMLV:1
		PRINT （不快感は感じていません）
	ELSEIF PALAM:C < PALAMLV:2
		PRINT （いい気分ではありません）
	ELSEIF PALAM:C < PALAMLV:4
		PRINT （気持ち悪いようです）
	ELSE
		PRINT （不快感で気が狂いそうです）
	ENDIF
;抑鬱
ELSEIF C == 13
	IF PALAM:C < PALAMLV:1
		PRINT （落ち込んではいません）
	ELSEIF PALAM:C < PALAMLV:2
		PRINT （やや元気に欠けます）
	ELSEIF PALAM:C < PALAMLV:4
		PRINT （落ち込んでいます）
	ELSE
		PRINT （全てに絶望しています）
	ENDIF
ENDIF

;
@FIGURE_INDENT_2
SIF N < 100000
	PRINT  
SIF N < 10000
	PRINT  
SIF N < 1000
	PRINT  
SIF N < 100
	PRINT  
SIF N < 10
	PRINT  
RETURN 1

;-------------------------------------------------
;ターゲットの体力バーを喪失分も含めて表示
;-------------------------------------------------
@LOSELIFE_BAR
SIF MAXBASE:体力 <= 0
	RETURN 0

PRINT  体力
A = (BASE:体力*32) / MAXBASE:体力
SIF BASE:体力 < 0
	A = 0
B = (LOSEBASE:体力*32) / MAXBASE:体力 + 1
SIF BASE:体力 < 0
	B = 0
PRINT [
IF A > 0
	REPEAT A
		PRINT =
	REND
ENDIF
IF B > 0
	REPEAT B
		PRINT -
	REND
ENDIF
IF 32 - (A+B) > 0
	REPEAT 32 - (A+B)
		PRINT .
	REND
ENDIF
PRINT ]

;-------------------------------------------------
;ターゲットの気力バーを喪失分も含めて表示
;-------------------------------------------------
@LOSEVITAL_BAR
SIF MAXBASE:気力 <= 0
	RETURN 0
PRINT  気力
A = (BASE:気力*32 + 16) / MAXBASE:気力
SIF BASE:気力 < 0
	A = 0
B = (LOSEBASE:気力*32 +16) / MAXBASE:気力 + 1
SIF BASE:気力 < 0
	B = 0
PRINT [
IF A > 0
	REPEAT A
		PRINT =
	REND
ENDIF
IF B > 0
	REPEAT B
		PRINT -
	REND
ENDIF
IF 32 - (A+B) > 0
	REPEAT 32 - (A+B)
		PRINT .
	REND
ENDIF
PRINT ]
;
;
;