;DAY:1は現在の月
;DAY:2は現在の日
;２月のうるう月は考えてません
;存在しない日付を弾く部分、初心者丸出しの処理です……
;もっとスマートなやり方がきっとあるはずorz

@IS_END_OF_MONTH
#FUNCTION
RETURNF (DAY:2 == 4 && (DAY:1 == 1 || DAY:1 == 2 || DAY:1 == 4 || DAY:1 == 6 || DAY:1 == 7 || DAY:1 == 9 || DAY:1 == 11 || DAY:1 == 12)) || (DAY:2 == 5 && ( DAY:1 == 3 || DAY:1 == 5 ||  DAY:1 == 8 || DAY:1 == 10))

;-------------------------------------------------
;各日の末日ならば月が替わる
;EVENT_TURNEND.ERBから呼び出される関数
;-------------------------------------------------
@EVENT_NEXTMONTH

G = 0
E = 0
M = 0

REPEAT CHARANUM
	IF !TALENT:COUNT:ＡＶ女優
		CONTINUE
	ELSE
		G += BASE:COUNT:ギャラ
			IF TALENT:COUNT:アンドロイド
				E += 1
			ENDIF
	ENDIF
REND	

IF DAY:1 == 4 && DAY:2 > 4 && DAY:3 == 0
	DAY:1 = DAY:1 + 1
	DAY:2 = 1
	PRINTFORML 明日からは{DAY:1}月だ……
ELSE
	IF DAY:2 > 4 && DAY:1 == 12
		DAY:1 = 1
		DAY:2 = 1
		PRINTFORML 明日からは新しい年の始まりだ……
		DAY:3 += 1
	ELSE
		DAY:1 = DAY:1 + 1
		DAY:2 = 1
		PRINTFORML 明日からは{DAY:1}月だ……
	ENDIF
	PRINTFORM 女優やスタッフの給料
	IF E > 0
		PRINTFORM や電気代
	ENDIF
	PRINTFORMW として{G}ポイント支払いました
	MONEY -= G
	CALL ENDING_CHECK
ENDIF
IF FLAG:習い事人数 > 0
	MONEY -= FLAG:習い事人数 * 10000
ENDIF
FLAG:治安悪化 += RAND:11
FLAG:治安悪化 -= RAND:6

SIF DAY:1 == 3  || DAY:1 == 6 || DAY:1 == 10 || DAY:1 == 12
	FLAG:治安悪化 -= (10 + RAND:11)

SIF FLAG:治安悪化 <= 0
	FLAG:治安悪化 = 0

IF FLAG:治安悪化 <= 24
	FLAG:治安悪化レベル = 0
ELSEIF FLAG:治安悪化 <= 49
	FLAG:治安悪化レベル = 1
ELSEIF FLAG:治安悪化 <= 75
	FLAG:治安悪化レベル = 2
ELSE
	FLAG:治安悪化レベル = 3
ENDIF	

CALL SET_VIDEOSALE
CALL CALC_B_NEXTMONTH